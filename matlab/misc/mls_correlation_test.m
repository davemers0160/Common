format long g
format compact
clc
close all
clearvars

% get the location of the script file to save figures
full_path = mfilename('fullpath');
[scriptpath,  filename, ext] = fileparts(full_path);

plot_num = 1;
line_width = 1.0;
cm = ['r', 'g', 'b', 'k'];

commandwindow;

%% create the taps for MLS

% tap_list = {[9,5],[9,8,7,2], [9,8,6,5], [9,8,5,4], [9,8,5,1], [9,8,4,2], [9,7,6,4], [9,7,5,2], [9,6,5,3], ...
%             [9,8,7,6,5,3], [9,8,7,6,5,1], [9,8,7,6,4,3], [9,8,7,6,4,2], [9,8,7,6,3,2], [9,8,7,6,3,1], [9,8,7,6,2,1], ...
%             [9,8,7,5,4,3], [9,8,7,5,4,2], [9,8,6,5,4,1], [9,8,6,5,3,2], [9,8,6,5,3,1], [9,7,6,5,4,3], [9,7,6,5,4,2], ...
%             [9,8,7,6,5,4,3,1] ...
%             };
        
tap_list = {[11, 9], [11, 10, 9, 7], [11, 10, 9, 5], [11, 10, 9, 2], [11, 10, 8, 6], [11, 10, 8, 1], [11, 10, 7, 3],...
    [11, 10, 7, 2], [11, 10, 6, 5], [11, 10, 4, 3], [11, 10, 3, 2], [11, 9, 8, 6], [11, 9, 8, 4], [11, 9, 8, 3],...
    [11, 9, 7, 4], [11, 9, 7, 2], [11, 9, 6, 5], [11, 9, 6, 3], [11, 9, 5, 3], [11, 8, 6, 4], [11, 8, 6, 3],...
    [11, 7, 6, 5], [11, 7, 6, 4], [11, 10, 9, 8, 7, 4], [11, 10, 9, 8, 7, 1], [11, 10, 9, 8, 5, 4], [11, 10, 9, 8, 4, 3],...
    [11, 10, 9, 8, 3, 1], [11, 10, 9, 7, 5, 1], [11, 10, 9, 7, 4, 1], [11, 10, 9, 6, 5, 4], [11, 10, 9, 6, 4, 2],...
    [11, 10, 9, 6, 3, 1], [11, 10, 9, 6, 2, 1], [11, 10, 9, 5, 4, 3], [11, 10, 9, 5, 4, 1], [11, 10, 9, 5, 3, 1],...
    [11, 10, 9, 4, 3, 2], [11, 10, 8, 7, 6, 5], [11, 10, 8, 7, 6, 3], [11, 10, 8, 7, 5, 3], [11, 10, 8, 7, 4, 1],...
    [11, 10, 8, 6, 5, 4], [11, 10, 8, 6, 5, 1], [11, 10, 8, 6, 4, 3], [11, 10, 8, 6, 4, 2], [11, 10, 8, 5, 3, 2],...
    [11, 10, 8, 4, 3, 2], [11, 10, 7, 6, 5, 3], [11, 10, 7, 6, 5, 1], [11, 10, 7, 6, 4, 2], [11, 10, 7, 6, 4, 1],...
    [11, 10, 7, 6, 3, 2], [11, 10, 7, 4, 3, 2], [11, 9, 8, 7, 6, 3], [11, 9, 8, 7, 4, 2], [11, 9, 8, 6, 5, 2],...
    [11, 9, 8, 6, 4, 3], [11, 9, 7, 6, 5, 4], [11, 9, 7, 6, 5, 3], [11, 9, 7, 6, 4, 2], [11, 9, 6, 5, 4, 3],...
    [11, 8, 7, 6, 4, 3], [11, 10, 9, 8, 7, 6, 5, 3], [11, 10, 9, 8, 7, 6, 5, 2], [11, 10, 9, 8, 7, 6, 4, 1],...
    [11, 10, 9, 8, 7, 6, 3, 2], [11, 10, 9, 8, 7, 5, 4, 2], [11, 10, 9, 8, 7, 5, 3, 2], [11, 10, 9, 8, 7, 5, 2, 1],...
    [11, 10, 9, 8, 7, 4, 3, 1], [11, 10, 9, 8, 7, 4, 2, 1], [11, 10, 9, 8, 6, 5, 4, 2], [11, 10, 9, 8, 6, 5, 3, 2],...
    [11, 10, 9, 8, 6, 5, 3, 1], [11, 10, 9, 8, 6, 4, 3, 2], [11, 10, 9, 8, 5, 4, 2, 1], [11, 10, 9, 7, 6, 5, 4, 3],...
    [11, 10, 9, 7, 6, 5, 4, 1], [11, 10, 9, 7, 6, 4, 3, 2], [11, 10, 9, 7, 5, 4, 3, 1], [11, 10, 9, 6, 5, 4, 3, 2],...
    [11, 10, 9, 6, 5, 4, 3, 1], [11, 10, 8, 7, 6, 5, 4, 2], [11, 10, 8, 7, 6, 4, 3, 1], [11, 10, 8, 7, 5, 4, 3, 2],...
    [11, 9, 8, 7, 6, 5, 3, 2], [11, 9, 8, 7, 6, 4, 3, 2]...
    };

sr_size = max(tap_list{1});
num_bits = 2^sr_size - 1;
        
%% create the MLS sequences
        
num_seq = numel(tap_list);

mls_seq = zeros(num_seq, num_bits);

for idx=1:num_seq
    mls_seq(idx,:) = maxmimal_length_seq(sr_size, tap_list{idx});
end
        
%% check the correlation

mls_seq_corr = zeros(num_seq,num_seq);

for idx = 1:num_seq
    for jdx = 1:num_seq
        mls_seq_corr(idx, jdx) = sum(mls_seq(idx,:) .* mls_seq(jdx,:));
    end
end

%% plot the result

figure;
surf(mls_seq_corr)
        